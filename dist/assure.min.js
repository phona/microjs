!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).assure=t()}}(function(){var t={};function e(){}var n=function(){function t(){this.isTimeout=!1,this.timeoutFlag=null}return t.prototype.send=function(t){var n,o,r=this,s=t.headers||{},i=(t.method||"GET").toUpperCase(),u=void 0===t.async||t.async,c=t.success||e,f=t.error||e,a=t.timeout;if(s["Content-Type"]||(s["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),"GET"===i){var h="string"==typeof(p=t.data||"")?p:function(t){var e=[];for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return"?"+e.join("&")}(p);n=t.data?t.url+h:t.url,o=null}else{var p=t.data||"";n=t.url,o="string"==typeof p?p:function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);return""+e.join("&")}(p)}var l=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;for(var t=["Microsoft","msxm3","msxml2","msxml1"],e=0;e<t.length;e++)try{return new ActiveXObject(t[e]+".XMLHTTP")}catch(n){}}();for(var d in l.open(i,n,u),l.onreadystatechange=function(){if(4===l.readyState){if(void 0!==a){if(r.isTimeout)return;clearTimeout(r.timeoutFlag)}l.status>=200&&l.status<300||304===l.status?c(l.responseText):f(l.status,l.statusText)}},s)l.setRequestHeader(d,s[d]);l.send(o),a&&(this.timeoutFlag=setTimeout(function(){r.isTimeout=!0,l&&l.abort()},a))},t}();t.default=function(t){(new n).send(t)};var o,r={},s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=function(t){function e(n,o){var r=this;return o||(o="HttpError: "+n),(r=t.call(this,o)||this).status=n,r.describe=o,Object.setPrototypeOf(r,e.prototype),r}return s(e,t),e}(Error);r.default=i;var u,c={};c.__esModule=!0,function(t){t[t.PENDING=0]="PENDING",t[t.FULFILLED=1]="FULFILLED",t[t.REJECTED=2]="REJECTED"}(u||(u={}));var f=function(){},a=function(){function t(t){if(this.asyncfn=t,"function"!=typeof t)throw new TypeError("Assure resolver "+t+" is not a function");this.children=[],this.result=null,this.state=u.PENDING,this.onResolved=null,this.onRejected=null}return t.prototype.pipe=function(t){this.then(function(e){t.state=u.FULFILLED,t.result=e,t.children.forEach(function(t){return t.process(e)})},function(e){t.state=u.REJECTED,t.result=e,t.children.forEach(function(t){return t.process(e)})})},t.prototype.process=function(e){if(this.result=e,e instanceof t)e.pipe(this);else if(e instanceof Error){var n=e;if(this.onRejected&&"function"==typeof this.onRejected)try{if((n=this.onRejected(e))instanceof t)return void n.pipe(this);this.result=n}catch(r){this.result=n=r}this.state=u.REJECTED,this.children.forEach(function(t){return t.process(n)})}else{var o=e;if(this.onResolved&&"function"==typeof this.onResolved)try{if(o=this.onResolved(e),this.state=u.FULFILLED,o instanceof t)return void o.pipe(this);void 0!==o&&(this.result=o)}catch(r){this.result=o=r,this.state=u.REJECTED}else this.state=u.FULFILLED;this.children.forEach(function(t){return t.process(o)})}},t.prototype.invokeAsyncFn=function(){var t=this;if(this.asyncfn!==f)try{this.asyncfn(function(e){t.state=u.FULFILLED,t.process(e)},function(e){t.state=u.REJECTED,t.process(e)})}catch(e){this.state=u.REJECTED,this.process(e)}},t.prototype.then=function(e,n){var o=new t(f);return o.onResolved=e,o.onRejected=n,this.children.push(o),this.state!==u.PENDING?o.process(this.result):this.invokeAsyncFn(),o},t.prototype.catch=function(e){var n=new t(f);return n.onRejected=e,this.children.push(n),this.state!==u.PENDING?n.process(this.result):this.invokeAsyncFn(),n},t}();function h(t){return new a(t)}function p(e,n,o){return h(function(s,i){var u={url:e,data:n,success:function(t){return s(t)},error:function(t,e){return i(new r.default(t,e))}};for(var c in o)u[c]=o[c];t.default(u)})}function l(e,n,o){return h(function(s,i){var u={url:e,data:n,method:"POST",success:function(t){return s(t)},error:function(t,e){return i(new r.default(t,e))}};for(var c in o)u[c]=o[c];t.default(u)})}return c.wrap=h,c.get=p,c.post=l,c.default={wrap:h,get:p,post:l,HttpError:r.default,STATE:u},c});