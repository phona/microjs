!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).assure=t()}}(function(){var t={},e=function(){},n=function(){function t(){this.isTimeout=!1,this.timeoutFlag=null}return t.prototype.send=function(t){var n,o,r=this,s=t.headers||{},i=(t.method||"GET").toUpperCase(),u=void 0===t.async||t.async,c=t.success||e,a=t.error||e,f=t.timeout;if(s["Content-Type"]||(s["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),"GET"===i){var h="string"==typeof(l=t.data||"")?l:"?"+function(t){var e=[];for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n].toString()));return e.join("&")}(l);n=t.data?t.url+h:t.url,o=null}else{var l=t.data||"";n=t.url,o="string"==typeof l?l:function(t){var e=[];for(var n in t)e.push(n+"="+t[n].toString());return""+e.join("&")}(l)}var p=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;for(var t=0,e=["Microsoft","msxm3","msxml2","msxml1"];t<e.length;t++){var n=e[t];try{return new ActiveXObject(n+".XMLHTTP")}catch(o){}}return null}();for(var d in p.open(i,n,u),p.onreadystatechange=function(){if(4===p.readyState){if(void 0!==f){if(r.isTimeout)return;clearTimeout(r.timeoutFlag)}p.status>=200&&p.status<300||304===p.status?c(p.responseText):a(p.status,p.statusText)}},s)p.setRequestHeader(d,s[d]);p.send(o),f&&(this.timeoutFlag=setTimeout(function(){r.isTimeout=!0,p&&p.abort()},f))},t}();t.default=function(t){(new n).send(t)};var o,r={},s=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=function(t){function e(e,n){var o=this;return n||(n="HttpError: "+e),(o=t.call(this,n)||this).status=e,o.describe=n,o}return s(e,t),e}(Error);r.default=i;var u,c={};c.__esModule=!0,c.post=c.get=c.wrap=void 0,function(t){t[t.PENDING=0]="PENDING",t[t.FULFILLED=1]="FULFILLED",t[t.REJECTED=2]="REJECTED"}(u||(u={}));var a=function(){},f=function(){function t(t){if(this.asyncfn=t,"function"!=typeof t)throw new TypeError("Assure resolver is not a function");this.children=[],this.result=null,this.state=u.PENDING,this.onResolved=null,this.onRejected=null}return t.prototype.pipe=function(t){this.then(function(e){t.state=u.FULFILLED,t.result=e,t.children.forEach(function(t){return t.process(e)})},function(e){t.state=u.REJECTED,t.result=e,t.children.forEach(function(t){return t.process(e)})})},t.prototype.process=function(e){if(this.result=e,e instanceof t)e.pipe(this);else if(e instanceof Error){var n=e;if(this.onRejected&&"function"==typeof this.onRejected)try{if((n=this.onRejected(e))instanceof t)return void n.pipe(this);this.result=n}catch(r){this.result=n=r}this.state=u.REJECTED,this.children.forEach(function(t){return t.process(n)})}else{var o=e;if(this.onResolved&&"function"==typeof this.onResolved)try{if(o=this.onResolved(e),this.state=u.FULFILLED,o instanceof t)return void o.pipe(this);void 0!==o&&(this.result=o)}catch(r){this.result=o=r,this.state=u.REJECTED}else this.state=u.FULFILLED;this.children.forEach(function(t){return t.process(o)})}},t.prototype.invokeAsyncFn=function(){var t=this;if(this.asyncfn!==a)try{this.asyncfn(function(e){t.state=u.FULFILLED,t.process(e)},function(e){t.state=u.REJECTED,t.process(e)})}catch(e){this.state=u.REJECTED,this.process(e)}},t.prototype.then=function(e,n){var o=new t(a);return o.onResolved=e,o.onRejected=n,this.children.push(o),this.state!==u.PENDING?o.process(this.result):this.invokeAsyncFn(),o},t.prototype.catch=function(e){var n=new t(a);return n.onRejected=e,this.children.push(n),this.state!==u.PENDING?n.process(this.result):this.invokeAsyncFn(),n},t}();function h(t){return new f(t)}function l(e){return h(function(n,o){var s={url:e.url,method:"GET",data:e.data,headers:e.headers,timeout:e.timeout,async:e.async,success:function(t){return n(t)},error:function(t,e){return o(new r.default(t,e))}};t.default(s)})}function p(e){return h(function(n,o){var s={url:e.url,method:"POST",data:e.data,headers:e.headers,timeout:e.timeout,async:e.async,success:function(t){return n(t)},error:function(t,e){return o(new r.default(t,e))}};t.default(s)})}return c.wrap=h,c.get=l,c.post=p,c.default={wrap:h,get:l,post:p,HttpError:r.default,STATE:u},c});